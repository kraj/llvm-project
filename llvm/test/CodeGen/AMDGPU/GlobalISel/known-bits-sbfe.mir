# NOTE: Assertions have been autogenerated by utils/update_givaluetracking_test_checks.py UTC_ARGS: --version 5
# RUN: llc -mtriple=amdgcn-mesa-mesa3d -mcpu=gfx900 -passes="print<gisel-value-tracking>" %s -o /dev/null 2>&1 | FileCheck %s

---
name: test_s_bfe_u32_constants
body: |
  bb.0:
  ; Extract [12:16)
  ; CHECK-LABEL: name: @test_s_bfe_u32_constants
  ; CHECK-NEXT: %cst:sgpr_32 KnownBits:00000000000000001111111111111111 SignBits:16
  ; CHECK-NEXT: %bfe:sgpr_32 KnownBits:00000000000000000000000000001111 SignBits:28
    %cst:sgpr_32(s32) = G_CONSTANT i32 65535
    %bfe:sgpr_32(s32) = S_BFE_U32 %cst, 262156, implicit-def $scc
    $sgpr0 = COPY %bfe
...
---
name: test_s_bfe_i32_constants
body: |
  bb.0:
  ; Extract [12:16)
  ; CHECK-LABEL: name: @test_s_bfe_i32_constants
  ; CHECK-NEXT: %cst:sgpr_32 KnownBits:00000000000000001111111111111111 SignBits:16
  ; CHECK-NEXT: %bfe:sgpr_32 KnownBits:11111111111111111111111111111111 SignBits:32
    %cst:sgpr_32(s32) = G_CONSTANT i32 65535
    %bfe:sgpr_32(s32) = S_BFE_I32 %cst, 262156, implicit-def $scc
    $sgpr0 = COPY %bfe
...
---
name: test_s_bfe_u64_constants
body: |
  bb.0:
  ; Extract [12:16)
  ; CHECK-LABEL: name: @test_s_bfe_u64_constants
  ; CHECK-NEXT: %cst:sgpr_64 KnownBits:0000000000000000000000000000000000000000000000001111111111111111 SignBits:48
  ; CHECK-NEXT: %bfe:sgpr_64 KnownBits:0000000000000000000000000000000000000000000000000000000000001111 SignBits:60
    %cst:sgpr_64(s64) = G_CONSTANT i64 65535
    %bfe:sgpr_64(s64) = S_BFE_U64 %cst, 262156, implicit-def $scc
    $sgpr0_sgpr1 = COPY %bfe
...
---
name: test_s_bfe_i64_constants
body: |
  bb.0:
  ; Extract [12:16)
  ; CHECK-LABEL: name: @test_s_bfe_i64_constants
  ; CHECK-NEXT: %cst:sgpr_64 KnownBits:0000000000000000000000000000000000000000000000001111111111111111 SignBits:48
  ; CHECK-NEXT: %bfe:sgpr_64 KnownBits:1111111111111111111111111111111111111111111111111111111111111111 SignBits:64
    %cst:sgpr_64(s64) = G_CONSTANT i64 65535
    %bfe:sgpr_64(s64) = S_BFE_I64 %cst, 262156, implicit-def $scc
    $sgpr0_sgpr1 = COPY %bfe
...
---
name: test_s_bfe_u32_middle_bits_unknown
body: |
  bb.0:
  ; Extract [8:16) but the middle 4 bits are ????
    liveins: $sgpr0

  ; CHECK-LABEL: name: @test_s_bfe_u32_middle_bits_unknown
  ; CHECK-NEXT: %input:sgpr_32 KnownBits:???????????????????????????????? SignBits:1
  ; CHECK-NEXT: %cst:sgpr_32 KnownBits:00000000000000001100001111111111 SignBits:16
  ; CHECK-NEXT: %mask:sgpr_32 KnownBits:00000000000000000011110000000000 SignBits:18
  ; CHECK-NEXT: %masked_input:sgpr_32 KnownBits:000000000000000000????0000000000 SignBits:18
  ; CHECK-NEXT: %merged:sgpr_32 KnownBits:000000000000000011????1111111111 SignBits:16
  ; CHECK-NEXT: %bfe:sgpr_32 KnownBits:00000000000000000000000011????11 SignBits:24
    %input:sgpr_32(s32) = COPY $sgpr0
    %cst:sgpr_32(s32) = G_CONSTANT i32 50175
    %mask:sgpr_32(s32) = G_CONSTANT i32 15360
    %masked_input:sgpr_32(s32) = G_AND %input, %mask
    %merged:sgpr_32(s32) = G_OR %masked_input, %cst
    %bfe:sgpr_32(s32) = S_BFE_U32 %merged, 524296, implicit-def $scc
    $sgpr0 = COPY %bfe
...
---
name: test_s_bfe_i32_middle_bits_unknown
body: |
  bb.0:
  ; Extract [8:16) but the middle 4 bits are ????
    liveins: $sgpr0

  ; CHECK-LABEL: name: @test_s_bfe_i32_middle_bits_unknown
  ; CHECK-NEXT: %input:sgpr_32 KnownBits:???????????????????????????????? SignBits:1
  ; CHECK-NEXT: %cst:sgpr_32 KnownBits:00000000000000001100001111111111 SignBits:16
  ; CHECK-NEXT: %mask:sgpr_32 KnownBits:00000000000000000011110000000000 SignBits:18
  ; CHECK-NEXT: %masked_input:sgpr_32 KnownBits:000000000000000000????0000000000 SignBits:18
  ; CHECK-NEXT: %merged:sgpr_32 KnownBits:000000000000000011????1111111111 SignBits:16
  ; CHECK-NEXT: %bfe:sgpr_32 KnownBits:11111111111111111111111111????11 SignBits:26
    %input:sgpr_32(s32) = COPY $sgpr0
    %cst:sgpr_32(s32) = G_CONSTANT i32 50175
    %mask:sgpr_32(s32) = G_CONSTANT i32 15360
    %masked_input:sgpr_32(s32) = G_AND %input, %mask
    %merged:sgpr_32(s32) = G_OR %masked_input, %cst
    %bfe:sgpr_32(s32) = S_BFE_I32 %merged, 524296, implicit-def $scc
    $sgpr0 = COPY %bfe
...
---
name: test_s_bfe_u64_middle_bits_unknown
body: |
  bb.0:
  ; Extract [8:16) but the middle 4 bits are ????
    liveins: $sgpr0_sgpr1

  ; CHECK-LABEL: name: @test_s_bfe_u64_middle_bits_unknown
  ; CHECK-NEXT: %input:sgpr_64 KnownBits:???????????????????????????????????????????????????????????????? SignBits:1
  ; CHECK-NEXT: %cst:sgpr_64 KnownBits:0000000000000000000000000000000000000000000000001100001111111111 SignBits:48
  ; CHECK-NEXT: %mask:sgpr_64 KnownBits:0000000000000000000000000000000000000000000000000011110000000000 SignBits:50
  ; CHECK-NEXT: %masked_input:sgpr_64 KnownBits:00000000000000000000000000000000000000000000000000????0000000000 SignBits:50
  ; CHECK-NEXT: %merged:sgpr_64 KnownBits:00000000000000000000000000000000000000000000000011????1111111111 SignBits:48
  ; CHECK-NEXT: %bfe:sgpr_64 KnownBits:0000000000000000000000000000000000000000000000000000000011????11 SignBits:56
    %input:sgpr_64(s64) = COPY $sgpr0_sgpr1
    %cst:sgpr_64(s64) = G_CONSTANT i64 50175
    %mask:sgpr_64(s64) = G_CONSTANT i64 15360
    %masked_input:sgpr_64(s64) = G_AND %input, %mask
    %merged:sgpr_64(s64) = G_OR %masked_input, %cst
    %bfe:sgpr_64(s64) = S_BFE_U64 %merged, 524296, implicit-def $scc
    $sgpr0_sgpr1 = COPY %bfe
...
---
name: test_s_bfe_i64_middle_bits_unknown
body: |
  bb.0:
  ; Extract [8:16) but the middle 4 bits are ????
    liveins: $sgpr0_sgpr1

  ; CHECK-LABEL: name: @test_s_bfe_i64_middle_bits_unknown
  ; CHECK-NEXT: %input:sgpr_64 KnownBits:???????????????????????????????????????????????????????????????? SignBits:1
  ; CHECK-NEXT: %cst:sgpr_64 KnownBits:0000000000000000000000000000000000000000000000001100001111111111 SignBits:48
  ; CHECK-NEXT: %mask:sgpr_64 KnownBits:0000000000000000000000000000000000000000000000000011110000000000 SignBits:50
  ; CHECK-NEXT: %masked_input:sgpr_64 KnownBits:00000000000000000000000000000000000000000000000000????0000000000 SignBits:50
  ; CHECK-NEXT: %merged:sgpr_64 KnownBits:00000000000000000000000000000000000000000000000011????1111111111 SignBits:48
  ; CHECK-NEXT: %bfe:sgpr_64 KnownBits:1111111111111111111111111111111111111111111111111111111111????11 SignBits:58
    %input:sgpr_64(s64) = COPY $sgpr0_sgpr1
    %cst:sgpr_64(s64) = G_CONSTANT i64 50175
    %mask:sgpr_64(s64) = G_CONSTANT i64 15360
    %masked_input:sgpr_64(s64) = G_AND %input, %mask
    %merged:sgpr_64(s64) = G_OR %masked_input, %cst
    %bfe:sgpr_64(s64) = S_BFE_I64 %merged, 524296, implicit-def $scc
    $sgpr0_sgpr1 = COPY %bfe
...
